{"version":3,"sources":["../src/main.js"],"names":["Utils","version","command","alias","description","action","template","cmd","today","format","configPath","process","env","HOME","readJson","err","configObj","console","error","notesDir","notesDirectory","days","todayPath","dataJSONPath","noteMdPath","lastNote","getDirs","pop","lastNotePath","lastNoteDataJSONPath","templateDataPath","mkdirs","copy","lastNoteData","hasPreviousNote","incompleteSections","code","map","section","incompleteItems","items","filter","item","status","Object","assign","dataJSON","log","green","length","forEach","incompleteSection","yellow","title","printIncompleteItems","existingSectionIndex","findIndex","data","push","mergedItems","writeJson","makeNote","watchCmd","cyan","configJSON","toDir","noteMd","access","constants","F_OK","badNotePath","newNoteCmd","readFile","toString","watch","sectionName","cliRefName","createSection","notesDirPath","homePath","initializeNotes","createDir","exit","ref","note","addNote","e","red","option","options","undefined","removeSection","changeStatus","removeNote","completeNote","incompleteNote","failNote","parse","argv"],"mappings":";;AAEA;;AAGA;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;IAAYA,K;;;;;;AAVZ;AAGA;;;AASA,oBACGC,OADH,CACW,OADX,EAEGC,OAFH,CAEW,gBAFX,EAGGC,KAHH,CAGS,GAHT,EAIGC,WAJH,CAIe,+BAJf,EAKGC,MALH,CAKU,UAASC,QAAT,EAAmBC,GAAnB,EAAwB;AAC9B,MAAG,CAACD,QAAJ,EAAc;AACZA,eAAW,SAAX;AACD;AACD,QAAME,QAAQ,wBAASC,MAAT,CAAgB,YAAhB,CAAd;AACA,MAAIC,aAAc,GAAEC,QAAQC,GAAR,CAAYC,IAAK,iBAArC;;AAEA,oBAAGC,QAAH,CAAYJ,UAAZ,EAAwB,CAACK,GAAD,EAAMC,SAAN,KAAoB;AAC1C,QAAID,GAAJ,EAASE,QAAQC,KAAR,CAAcH,GAAd;;AAET,UAAMI,WAAWH,UAAUI,cAA3B;AACA,UAAMC,OAAQ,GAAEF,QAAS,QAAzB;AACA,UAAMG,YAAYD,OAAOb,KAAzB;AACA,UAAMe,eAAgB,GAAED,SAAU,YAAlC;AACA,UAAME,aAAc,GAAEF,SAAU,UAAhC;;AAEA,UAAMG,WAAWzB,MAAM0B,OAAN,CAAcL,IAAd,EAAoBM,GAApB,EAAjB;AACA,UAAMC,eAAeP,OAAOI,QAA5B;AACA,UAAMI,uBAAwB,GAAED,YAAa,YAA7C;;AAEA,UAAME,mBAAoB,GAAEX,QAAS,cAAab,QAAS,OAA3D;;AAEA,sBAAGyB,MAAH,CAAUT,SAAV,EAAsBP,GAAD,IAAS;AAC5B,UAAIA,GAAJ,EAASE,QAAQC,KAAR,CAAcH,GAAd;;AAET,wBAAGiB,IAAH,CAAQF,gBAAR,EAA0BP,YAA1B,EAAyCR,GAAD,IAAS;AAC/C,YAAIA,GAAJ,EAASE,QAAQC,KAAR,CAAcH,GAAd;;AAET,0BAAGD,QAAH,CAAYe,oBAAZ,EAAkC,CAACd,GAAD,EAAMkB,YAAN,KAAuB;AACvD,cAAIC,kBAAkB,IAAtB;AACA,cAAIC,qBAAqB,EAAzB;;AAEA,cAAIpB,OAAOA,IAAIqB,IAAJ,KAAa,QAAxB,EAAkC;AAChCF,8BAAkB,KAAlB;AACD;;AAED,cAAIA,eAAJ,EAAqB;AACnBC,iCAAqBF,aAAaI,GAAb,CAAiBC,WAAW;AAC/C,oBAAMC,kBAAkBD,QAAQE,KAAR,CAAcC,MAAd,CAAqBC,QAAQ;AACnD,uBAAOA,KAAKC,MAAL,KAAgB,UAAvB;AACD,eAFuB,CAAxB;;AAIA,qBAAOC,OAAOC,MAAP,CAAcP,OAAd,EAAuB,EAACE,OAAOD,eAAR,EAAvB,CAAP;AACD,aANoB,CAArB;AAOD;;AAED,4BAAGzB,QAAH,CAAYS,YAAZ,EAA0B,CAACR,GAAD,EAAM+B,QAAN,KAAmB;AAC3C7B,oBAAQ8B,GAAR,CAAa,8BAA6B,gBAAMC,KAAN,CAAY1C,QAAZ,CAAsB,cAAhE;AACA,gBAAI4B,mBAAmBC,mBAAmBc,MAAnB,GAA4B,CAAnD,EAAsD;AACpDd,iCAAmBe,OAAnB,CAA4BC,iBAAD,IAAuB;AAChDlC,wBAAQ8B,GAAR,CAAa,aAAY,gBAAMK,MAAN,CAAaD,kBAAkBE,KAA/B,CAAsC,mCAA/D;;AAEArD,sBAAMsD,oBAAN,CAA2BH,kBAAkBX,KAA7C;;AAEA,sBAAMe,uBAAuBT,SAASU,SAAT,CAAoBC,IAAD,IAAUA,KAAKJ,KAAL,KAAeF,kBAAkBE,KAA9D,CAA7B;;AAEA,oBAAGE,yBAAyB,CAAC,CAA7B,EAAgC;AAC9BT,2BAASY,IAAT,CAAcP,iBAAd;AACD,iBAFD,MAEO;AACL,wBAAMQ,cAAc,CAAE,GAAGb,SAASS,oBAAT,EAA+Bf,KAApC,EAA2C,GAAGW,kBAAkBX,KAAhE,CAApB;AACAM,2BAASS,oBAAT,IAAiCX,OAAOC,MAAP,CAAcM,iBAAd,EAAiC,EAAEX,OAAOmB,WAAT,EAAjC,CAAjC;AACD;AACF,eAbD;AAcD;;AAED,8BAAGC,SAAH,CAAarC,YAAb,EAA2BuB,QAA3B,EAAsC/B,GAAD,IAAS;AAC5C,kBAAIA,GAAJ,EAAS,OAAOE,QAAQC,KAAR,CAAcH,GAAd,CAAP;;AAETf,oBAAM6D,QAAN,CAAef,QAAf;AACA,oBAAMgB,WAAW,YAAjB;AACA7C,sBAAQ8B,GAAR,CAAa,mDAAkD,gBAAMgB,IAAN,CAAWvC,UAAX,CAAuB,EAAtF;AACAP,sBAAQ8B,GAAR,CAAa,qCAAoC,gBAAMC,KAAN,CAAYc,QAAZ,CAAsB,4BAAvE;AACD,aAPD;AAQD,WA3BD;AA4BD,SA9CD;AA+CD,OAlDD;AAmDD,KAtDD;AAuDD,GAtED;AAuED,CAnFH;;AAsFA,oBACG5D,OADH,CACW,OADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAGe,qBAHf,EAIGC,MAJH,CAIU,YAAU;AAChB,oBAAG,aAAa;AACd,UAAMG,QAAQ,wBAASC,MAAT,CAAgB,YAAhB,CAAd;AACA,QAAIC,aAAc,GAAEC,QAAQC,GAAR,CAAYC,IAAK,iBAArC;AACA,sBAAGC,QAAH,CAAYJ,UAAZ,EAAwB,CAACK,GAAD,EAAMiD,UAAN,KAAqB;AAC3C,UAAIjD,GAAJ,EAASE,QAAQC,KAAR,CAAcH,GAAd;;AAET,YAAMI,WAAW6C,WAAW5C,cAA5B;AACA,YAAMC,OAAQ,GAAEF,QAAS,QAAzB;AACA,YAAM8C,QAAQ5C,OAAOb,KAArB;AACA,YAAM0D,SAAU,GAAED,KAAM,UAAxB;;AAEA,wBAAGE,MAAH,CAAUD,MAAV,EAAkB,kBAAGE,SAAH,CAAaC,IAA/B,EAAsCtD,GAAD,IAAS;AAC5C,YAAIA,OAAOA,IAAIqB,IAAJ,KAAa,QAAxB,EAAkC;AAChC,gBAAMkC,cAAc,gBAAMP,IAAN,CAAWG,MAAX,CAApB;AACA,gBAAMK,aAAa,gBAAMvB,KAAN,CAAY,UAAZ,CAAnB;AACA/B,kBAAQ8B,GAAR,CAAa;;EAEvBuB,WAAY;;;EAGZC,UAAW;aALD;AAOA;AACD;;AAED,0BAAGC,QAAH,CAAYN,MAAZ,EAAoB,CAACnD,GAAD,EAAM0C,IAAN,KAAe;AACjC,cAAI1C,GAAJ,EAAS,MAAMA,GAAN;AACTE,kBAAQ8B,GAAR,CAAY,OAAZ;AACA9B,kBAAQ8B,GAAR,CAAYU,KAAKgB,QAAL,EAAZ;AACD,SAJD;;AAMA,0BAAGC,KAAH,CAASR,MAAT,EAAiB,MAAM;AACrB,4BAAGM,QAAH,CAAYN,MAAZ,EAAoB,CAACnD,GAAD,EAAM0C,IAAN,KAAe;AACjC,gBAAI1C,GAAJ,EAAS,MAAMA,GAAN;AACTE,oBAAQ8B,GAAR,CAAY,OAAZ;AACA9B,oBAAQ8B,GAAR,CAAYU,KAAKgB,QAAL,EAAZ;AACD,WAJD;AAKD,SAND;AAOD,OA3BD;AA4BD,KApCD;AAqCD,GAxCD;AAyCD,CA9CH;;AAiDA,oBACGvE,OADH,CACW,SADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAGe,oBAHf,EAIGC,MAJH,CAIU,YAAW;AACjB,oBAAG,aAAa;AACd,UAAMsE,cAAc,MAAM,wBAAO,oBAAP,CAA1B;AACA,UAAMC,aAAa,MAAM,wBAAO,qBAAP,CAAzB;AACA,UAAMxE,cAAc,MAAM,wBAAO,qBAAP,CAA1B;;AAEAJ,UAAM6E,aAAN,CAAoBF,WAApB,EAAiCC,UAAjC,EAA6CxE,WAA7C;;AAEAa,YAAQ8B,GAAR,CAAY,gBAAMC,KAAN,CAAa,gBAAe2B,WAAY,gBAAxC,CAAZ;AACD,GARD;AASD,CAdH;;AAgBA,oBACGzE,OADH,CACW,MADX,EAEGE,WAFH,CAEe,mBAFf,EAGGC,MAHH,CAGU,YAAW;AACjB,oBAAG,aAAa;AACd,UAAMyE,eAAe,MAAM,wBAAO,qCAAP,CAA3B;AACA,UAAMC,WAAY,GAAEpE,QAAQC,GAAR,CAAYC,IAAK,IAAGiE,YAAa,EAArD;AACA9E,UAAMgF,eAAN,CAAsBD,QAAtB;;AAEA/E,UAAMiF,SAAN,CAAgBF,QAAhB;AACA9D,YAAQ8B,GAAR,CAAY,yBAAZ,EAAuC,gBAAMC,KAAN,CAAY,aAAZ,CAAvC;AACA;AACArC,YAAQuE,IAAR;AACD,GATD;AAUD,CAdH;;AAgBA,oBACGhF,OADH,CACW,0BADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAGe,oBAHf,EAIGC,MAJH,CAIU,UAAS8E,GAAT,EAAcC,IAAd,EAAoB;AAC1B,MAAI;AACFpF,UAAMqF,OAAN,CAAcD,IAAd,EAAoBD,GAApB;AACAlE,YAAQ8B,GAAR,CAAY,gBAAMC,KAAN,CAAY,aAAZ,CAAZ;AACD,GAHD,CAGE,OAAOsC,CAAP,EAAU;AACVrE,YAAQ8B,GAAR,CAAY,gBAAMwC,GAAN,CAAUD,CAAV,CAAZ;AACD;AACF,CAXH;;AAaA,oBACGpF,OADH,CACW,0BADX,EAEGC,KAFH,CAES,GAFT,EAGGqF,MAHH,CAGU,eAHV,EAG2B,kBAH3B,EAIGpF,WAJH,CAIe,8BAJf,EAKGC,MALH,CAKU,UAAS8E,GAAT,EAAcC,IAAd,EAAoBK,OAApB,EAA6B;AACnC,MAAIA,QAAQnD,OAAR,IAAmB8C,SAASM,SAAhC,EAA2C;AACzC1F,UAAM2F,aAAN,CAAoBR,GAApB;AACD,GAFD,MAEO;AACL,QAAI;AACFnF,YAAM4F,YAAN,CAAmBR,IAAnB,EAAyBD,GAAzB,EAA8BnF,MAAM6F,UAApC;AACA5E,cAAQ8B,GAAR,CAAY,gBAAMC,KAAN,CAAa,iBAAgBoC,IAAK,gBAAlC,CAAZ;AACD,KAHD,CAGE,OAAOE,CAAP,EAAU;AACVrE,cAAQ8B,GAAR,CAAY,gBAAMwC,GAAN,CAAUD,CAAV,CAAZ;AACD;AACF;AACF,CAhBH;;AAkBA,oBACGpF,OADH,CACW,4BADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAGe,uBAHf,EAIGC,MAJH,CAIU,UAAS8E,GAAT,EAAcC,IAAd,EAAoB;AAC1B,MAAI;AACFpF,UAAM4F,YAAN,CAAmBR,IAAnB,EAAyBD,GAAzB,EAA8BnF,MAAM8F,YAApC;AACA7E,YAAQ8B,GAAR,CAAY,gBAAMC,KAAN,CAAa,iBAAgBoC,IAAK,2BAAlC,CAAZ;AACD,GAHD,CAGE,OAAOE,CAAP,EAAU;AACVrE,YAAQ8B,GAAR,CAAY,gBAAMwC,GAAN,CAAUD,CAAV,CAAZ;AACD;AACF,CAXH;;AAaA,oBACGpF,OADH,CACW,8BADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAGe,yBAHf,EAIGC,MAJH,CAIU,UAAS8E,GAAT,EAAcC,IAAd,EAAoB;AAC1B,MAAI;AACFpF,UAAM4F,YAAN,CAAmBR,IAAnB,EAAyBD,GAAzB,EAA8BnF,MAAM+F,cAApC;AACA9E,YAAQ8B,GAAR,CAAY,gBAAMC,KAAN,CAAa,iBAAgBoC,IAAK,6BAAlC,CAAZ;AACD,GAHD,CAGE,OAAOE,CAAP,EAAU;AACVrE,YAAQ8B,GAAR,CAAY,gBAAMwC,GAAN,CAAUD,CAAV,CAAZ;AACD;AACF,CAXH;;AAcA,oBACGpF,OADH,CACW,0BADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAGe,qBAHf,EAIGC,MAJH,CAIU,UAAS8E,GAAT,EAAcC,IAAd,EAAoB;AAC1B,MAAI;AACFpF,UAAM4F,YAAN,CAAmBR,IAAnB,EAAyBD,GAAzB,EAA8BnF,MAAMgG,QAApC;AACA/E,YAAQ8B,GAAR,CAAY,gBAAMC,KAAN,CAAa,iBAAgBoC,IAAK,2BAAlC,CAAZ;AACD,GAHD,CAGE,OAAOE,CAAP,EAAU;AACVrE,YAAQ8B,GAAR,CAAY,gBAAMwC,GAAN,CAAUD,CAAV,CAAZ;AACD;AACF,CAXH;;AAaE,oBAAQW,KAAR,CAActF,QAAQuF,IAAtB","file":"main.js","sourcesContent":["\n\nimport { install } from 'source-map-support';\ninstall();\n\nimport 'babel-polyfill';\n// Libs\nimport chalk from 'chalk';\nimport program from 'commander';\nimport fs from 'fs-extra';\nimport moment from 'moment';\nimport co from 'co';\nimport prompt from 'co-prompt';\nimport * as Utils from './utils';\n\nprogram\n  .version('0.0.1')\n  .command('new [template]')\n  .alias('n')\n  .description('create a new note for the day')\n  .action(function(template, cmd) {\n    if(!template) {\n      template = 'default';\n    }\n    const today = moment().format(\"DD-MM-YYYY\");\n    var configPath = `${process.env.HOME}/.nonoterc.json`;\n\n    fs.readJson(configPath, (err, configObj) => {\n      if (err) console.error(err)\n\n      const notesDir = configObj.notesDirectory;\n      const days = `${notesDir}/days/`;\n      const todayPath = days + today;\n      const dataJSONPath = `${todayPath}/data.json`;\n      const noteMdPath = `${todayPath}/note.md`;\n\n      const lastNote = Utils.getDirs(days).pop();\n      const lastNotePath = days + lastNote;\n      const lastNoteDataJSONPath = `${lastNotePath}/data.json`;\n\n      const templateDataPath = `${notesDir}/templates/${template}.json`;\n\n      fs.mkdirs(todayPath, (err) => {\n        if (err) console.error(err)\n\n        fs.copy(templateDataPath, dataJSONPath, (err) => {\n          if (err) console.error(err)\n\n          fs.readJson(lastNoteDataJSONPath, (err, lastNoteData) => {\n            let hasPreviousNote = true;\n            let incompleteSections = [];\n\n            if (err && err.code === 'ENOENT') {\n              hasPreviousNote = false;\n            }\n\n            if (hasPreviousNote) {\n              incompleteSections = lastNoteData.map(section => {\n                const incompleteItems = section.items.filter(item => {\n                  return item.status !== \"complete\"\n                });\n\n                return Object.assign(section, {items: incompleteItems})\n              });\n            }\n\n            fs.readJson(dataJSONPath, (err, dataJSON) => {\n              console.log(`Creating new note from the ${chalk.green(template)} template...`);\n              if (hasPreviousNote && incompleteSections.length > 0) {\n                incompleteSections.forEach((incompleteSection) => {\n                  console.log(`\\nCopying ${chalk.yellow(incompleteSection.title)} incomplete tasks from yesterday:`);\n\n                  Utils.printIncompleteItems(incompleteSection.items);\n\n                  const existingSectionIndex = dataJSON.findIndex((data) => data.title === incompleteSection.title);\n\n                  if(existingSectionIndex === -1) {\n                    dataJSON.push(incompleteSection);\n                  } else {\n                    const mergedItems = [ ...dataJSON[existingSectionIndex].items, ...incompleteSection.items ];\n                    dataJSON[existingSectionIndex] = Object.assign(incompleteSection, { items: mergedItems });\n                  }\n                });\n              }\n\n              fs.writeJson(dataJSONPath, dataJSON, (err) => {\n                if (err) return console.error(err)\n\n                Utils.makeNote(dataJSON);\n                const watchCmd = 'nono watch';\n                console.log(`\\nGreat success! Here is your note for today: \\n${chalk.cyan(noteMdPath)}`);\n                console.log(`\\nYou can see the note by running ${chalk.green(watchCmd)} anywhere in your console!`);\n              });\n            })\n          });\n        });\n      });\n    });\n  });\n\n\nprogram\n  .command('watch')\n  .alias('w')\n  .description('watches todays note')\n  .action(function(){\n    co(function *() {\n      const today = moment().format(\"DD-MM-YYYY\");\n      var configPath = `${process.env.HOME}/.nonoterc.json`;\n      fs.readJson(configPath, (err, configJSON) => {\n        if (err) console.error(err)\n\n        const notesDir = configJSON.notesDirectory;\n        const days = `${notesDir}/days/`;\n        const toDir = days + today;\n        const noteMd = `${toDir}/note.md`;\n\n        fs.access(noteMd, fs.constants.F_OK, (err) => {\n          if (err && err.code === 'ENOENT') {\n            const badNotePath = chalk.cyan(noteMd);\n            const newNoteCmd = chalk.green('nono new');\n            console.log(`\nOh man, oh jeez, ok, I-I-I can't access this note:\n${badNotePath}\n\nC-c-can you try m-m-making a new note or s-s-something?\n${newNoteCmd}\n            `);\n            return;\n          }\n\n          fs.readFile(noteMd, (err, data) => {\n            if (err) throw err;\n            console.log('\\x1Bc');\n            console.log(data.toString());\n          });\n\n          fs.watch(noteMd, () => {\n            fs.readFile(noteMd, (err, data) => {\n              if (err) throw err;\n              console.log('\\x1Bc');\n              console.log(data.toString());\n            });\n          });\n        });\n      });\n    });\n  });\n\n\nprogram\n  .command('section')\n  .alias('s')\n  .description('create new section')\n  .action(function() {\n    co(function *() {\n      const sectionName = yield prompt('New section name: ');\n      const cliRefName = yield prompt('Cli reference key: ');\n      const description = yield prompt('Short description: ');\n\n      Utils.createSection(sectionName, cliRefName, description);\n\n      console.log(chalk.green(`new section '${sectionName}' was created!`));\n    });\n  });\n\nprogram\n  .command('init')\n  .description('initializes notes')\n  .action(function() {\n    co(function *() {\n      const notesDirPath = yield prompt('notes directory path (from $HOME): ');\n      const homePath = `${process.env.HOME}/${notesDirPath}`;\n      Utils.initializeNotes(homePath);\n\n      Utils.createDir(homePath);\n      console.log('Start taking notes with', chalk.green('nonote new!'));\n      // TODO: create a readme\n      process.exit();\n    })\n  });\n\nprogram\n  .command('add <cli-ref> [notes...]')\n  .alias('a')\n  .description('add note to object')\n  .action(function(ref, note) {\n    try {\n      Utils.addNote(note, ref);\n      console.log(chalk.green('note added!'));\n    } catch (e) {\n      console.log(chalk.red(e));\n    }\n  });\n\nprogram\n  .command('remove <cli-ref> [index]')\n  .alias('r')\n  .option('-s, --section', 'remove a seciton')\n  .description('remove note from note object')\n  .action(function(ref, note, options) {\n    if (options.section && note === undefined) {\n      Utils.removeSection(ref);\n    } else {\n      try {\n        Utils.changeStatus(note, ref, Utils.removeNote);\n        console.log(chalk.green(`note at index[${note}] was removed!`));\n      } catch (e) {\n        console.log(chalk.red(e));\n      }\n    }\n  });\n\nprogram\n  .command('complete <cli-ref> [index]')\n  .alias('c')\n  .description('mark item as complete')\n  .action(function(ref, note) {\n    try {\n      Utils.changeStatus(note, ref, Utils.completeNote);\n      console.log(chalk.green(`note at index[${note}] was marked as complete!`));\n    } catch (e) {\n      console.log(chalk.red(e));\n    }\n  });\n\nprogram\n  .command('incomplete <cli-ref> [index]')\n  .alias('i')\n  .description('mark item as incomplete')\n  .action(function(ref, note) {\n    try {\n      Utils.changeStatus(note, ref, Utils.incompleteNote);\n      console.log(chalk.green(`note at index[${note}] was marked as incomplete!`));\n    } catch (e) {\n      console.log(chalk.red(e));\n    }\n  });\n\n\nprogram\n  .command('failed [cli-ref] <index>')\n  .alias('f')\n  .description('mark item as failed')\n  .action(function(ref, note) {\n    try {\n      Utils.changeStatus(note, ref, Utils.failNote);\n      console.log(chalk.green(`note at index[${note}] was marked as failed :(`));\n    } catch (e) {\n      console.log(chalk.red(e));\n    }\n  });\n\n  program.parse(process.argv);\n\n"]}